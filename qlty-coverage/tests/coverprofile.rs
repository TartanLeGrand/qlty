use qlty_coverage::parser::Coverprofile;
use qlty_coverage::Parser;

#[test]
fn coverprofile_results() {
    // Make sure that the <?xml version="1.0"?> tag is always right at the beginning of the string to avoid parsing errors
    let input = include_str!("fixtures/coverprofile/sample.out");

    let parsed_results = Coverprofile::new().parse_text(input).unwrap();
    insta::assert_yaml_snapshot!(parsed_results, @r#"
    - path: github.com/codeclimate/test-reporter/formatters/report.go
      hits:
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "-1"
        - "-1"
        - "1"
        - "-1"
        - "-1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "0"
        - "0"
        - "0"
        - "-1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "-1"
        - "-1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "-1"
        - "-1"
        - "1"
        - "-1"
        - "-1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "-1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "-1"
        - "-1"
        - "0"
        - "0"
        - "0"
        - "0"
        - "0"
        - "0"
        - "0"
    - path: github.com/codeclimate/test-reporter/formatters/source_file.go
      hits:
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "-1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "-1"
        - "-1"
        - "1"
        - "1"
        - "1"
        - "-1"
        - "-1"
        - "-1"
        - "1"
        - "1"
        - "1"
        - "-1"
        - "-1"
        - "1"
        - "1"
        - "-1"
        - "-1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "-1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "-1"
        - "1"
        - "-1"
        - "1"
        - "1"
        - "-1"
        - "-1"
        - "1"
        - "0"
        - "0"
        - "0"
        - "0"
        - "-1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "0"
        - "0"
        - "0"
        - "0"
        - "0"
        - "0"
        - "0"
        - "-1"
        - "-1"
        - "1"
        - "1"
        - "1"
        - "0"
        - "0"
        - "0"
        - "1"
        - "0"
        - "0"
        - "0"
        - "0"
        - "0"
        - "-1"
        - "1"
        - "-1"
        - "1"
    - path: github.com/codeclimate/test-reporter/formatters/coverage.go
      hits:
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "0"
        - "0"
        - "0"
        - "0"
        - "0"
        - "0"
        - "0"
        - "0"
        - "0"
        - "0"
        - "0"
        - "-1"
        - "-1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "1"
        - "0"
        - "0"
        - "0"
        - "1"
        - "1"
    - path: github.com/codeclimate/test-reporter/formatters/line_counts.go
      hits:
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "-1"
        - "1"
        - "1"
        - "1"
    "#);
}
